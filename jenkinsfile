addBuildConfigurations(
  [
          [
                  $class: 'BuildConfigProjectProperty',
                  name: '',
                  namespace: '',
                  resourceVersion: '',
                  uid: ''
          ],
          buildDiscarder(
                  logRotator(
                          artifactDaysToKeepStr: '',
                          artifactNumToKeepStr: '',
                          daysToKeepStr: '1',
                          numToKeepStr: ''
                  )
          ),
          gitLabConnection('gitlab-tlv'),
          [
                  $class: 'RebuildSettings',
                  autoRebuild: false,
                  rebuildDisabled: false
          ]
  ]
)

// addBuildParameters(
//     [
//         string(defaultValue: 'flotsam', description: 'One part of a shipwreck', name: 'FLOTSAM'),
//         string(defaultValue: 'jetsam', description: 'Another part of a shipwreck', name: 'JETSAM'),
//
//     ]
// )
node(){
    stage("pre-flight"){
        deleteDir()
        git branch: 'development', url: 'https://github.com/robnester-rh/hdsl_test'
        env.buildParameters = [:]
        env.buildConfigurations = []
    }

    stage("Parse Configuration"){
        parseConfigYaml()
    }

    stage("Test params"){
        echo "I'm ${params.ANSIBLE_EXECUTOR_TAG}!"
        echo "What's a part of a shipwreck? ${params.FLOTSAM}!"
        echo "What's another part of a shipwreck? ${params.JETSAM}!"
    }

    // stage("Deploy Infra"){
    //     deployInfra()
    // }
    // stage("Test Pinfile"){
    //     sh "pwd"
    //     sh "ls -lah *"
    //     a = readFile 'linchpin/PinFile'
    //     echo "PinFile Content:\n${a}"
    // }
    // archiveArtifacts '*, linchpin/*'

}
